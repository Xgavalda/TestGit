#GIT

## Instalacio
Baixar els paquets segons diu la pagina. I lo tipic enter+enter+enter....

## Funcions Globals

### Git Nom usuari

**Inicialitzar**

```git config --global user.name "Xavier Gavaldà"```

**Veure nom**

```git config --global user.name```

**Change**

```git config --global user.name "Xavier Gavaldà"```

### Git Email

```git config --global user.email "xgavalda@gmail.com"```


### Git Programacio de Colors

```git config --global color.ui true```

### Llistat de configuracions

```git config --global --list```

### Git HELP
Ajuda general

	git help 

Ajuda un comandament per defecta per exemple de comandament 'add'
	
	git help add

## .gitignore

Es un fitxer per ignorar fitxers, directoris, etc...

[Dins d'aquestes pagina tens una relacio .gitignore que fa servir GITHUB](https://github.com/github/gitignore)

Una mostra de .gitignore [nodejs]

	# Logs
	logs
	*.log
	npm-debug.log*

	# Runtime data
	pids
	*.pid
	*.seed
	*.webloc
	.DS_Store
	.gitignore
	
	# Directory for instrumented libs generated by jscoverage/JSCover
	lib-cov
	
	# Coverage directory used by tools like istanbul
	coverage
	
	# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
	.grunt
	
	# node-waf configuration
	.lock-wscript
	
	# Compiled binary addons (http://nodejs.org/api/addons.html)
	build/Release
	
	# Dependency directory
	# https://docs.npmjs.com/misc/faq#should-i-check-my-node-modules-folder-into-git
	node_modules
	
	# Optional npm cache directory
	.npm
	
	# Optional REPL history
	.node_repl_history
	Status API Training Shop Blog About Pricing
	
Un exemple que te codigoFacilito[1]

	#compiled source#
	#################
	*.com
	*.exe
	*.class
	*.dll
	*.o
	*.so
	*.sh
	
	# Packages #
	############
	*.7z
	*.dmg
	*.gz
	*.iso
	*.jar
	*.rar
	*.tar
	*.zip
	
	# Logs and databases #
	######################
	*.log
	*.sql
	*.sqlite
	
	# OS/MSDOS generated files #
	############################
	.DS_Store
	.DS_Store?
	._*
	.Trashes
	.ehthumbs.db
	Thumbs.db
	*.bak

## Workflow amb LOCAL

###Inicialitzacio

```git init```

###Estat

Mostra com te els fitxers

```git status```

La Sortida es aquesta que vol dir que tens tot això per afegir que et faci el treking.

	On branch master
	
	Initial commit
	
	Untracked files:
	  (use "git add <file>..." to include in what will be committed)
	
		.DS_Store
		Crear el juego Agar.io con JQuery y Node.js - parte 8 - YouTube.webloc
		node_modules/
		public/
		servidor.js
	
	nothing added to commit but untracked files present (use "git add" to track)


###Afegeix UN fitxer

```git add servidor.js```

###Afegeix TOTs el fitxers

```git add -A```

###Afegeix un comentario [Obligatori]

```git commit -m "Inicialitzacio"```

	Comença amb:
		git init
		
		[treballar "per exemple pagina html]
		git add index.html
		git commit -m "Inicialitzacio pagina HTML"
		git add style.css
		git commit -m "Agefeix pagina CSS"
		git add app.js
		git commit -m "Agefeix fulla JAVASCRIPT"
		
**TIPS**

Corretgir un NOM de COMMIT erroni

```git commit --amend -m "Descripcio CORRECTA"```


###Quants COMMITs tens fets.

```git log```

	XGavalda:Agar xgavalda$ git log
	commit d4d79921df314c74bcbd3234546a26624b8ea962
	Author: Xavier Gavalda <xgavalda@gmail.com>
	Date:   Sat Jan 9 09:57:44 2016 +0100
	
	    Explicacio de SOCKER
	
	commit 62fcc3f3383e7bfa18114368e44e6e0195c251b6
	Author: Xavier Gavalda <xgavalda@gmail.com>
	Date:   Sat Jan 9 09:54:00 2016 +0100
	
	    Afageix tot
	
	commit efeffc645b0a99b80e50aa21b9bef58eafcd86a4
	Author: Xavier Gavalda <xgavalda@gmail.com>
	Date:   Sat Jan 9 09:47:18 2016 +0100
	
	    explicacio de connection
	
	commit c7a82d81c929717149fce33ef2eecf5fc327a972
	Author: Xavier Gavalda <xgavalda@gmail.com>
	Date:   Sat Jan 9 09:45:22 2016 +0100
	
	    inicialitzar

**TRIP**
	    
```git log > LOGS.txt ```

###Canviar de COMMITs
	git checkout (MD5=commit)
	
	per exemple anterior
	
	git checkout efeffc645b0a99b80e50aa21b9bef58eafcd86a4
	
	aniria a explicacio de connection


```git checkout master``` 

###Borrar COMMIT's

3 Nivells de borrats

####GIT RESET --SOFT (nivell 1)
Aquest  solament borra el Working AREA (no toca el codig actual) "Borra un commit".
	
	git reset --soft (MD5)

####GIT RESET --MIXED (nivell 2)
Aquest solament borra "Stating Area" (no toca el codig actual).

####GIT RESET --HARD (nivell 3) "Borrar tot fins aquell commit"
Borrar tot originals i commits.

	git reset --hard (MD5)
	
	
## Branques i Fusions

**HEAD** Posicio de on estas dins dels commits.


**BRANQUES** Una lina paralela del projecta

**MASTER** Es la branca princial.

###Mostra les branques
	
```git branch```
		
		XGavalda:Agar xgavalda$ git branch
		
		* master

###Crea una branca

```git branch EXPERIMENTAL```
				
		XGavalda:Agar xgavalda$ git branch EXPERIMENTAL
		XGavalda:Agar xgavalda$ git branch
		EXPERIMENTAL
		* master

**TIPS**

Permet veure branques que no es veuen per quan s'ha treballa amb **grups**

```git branch -a```

**TIPS**

Permet crea una branca i ANAR-HI


```git checkout -b BrancaProves```


###Com canviar de branques

```git checkout EXPERIMENTAL```

		XGavalda:Agar xgavalda$ git checkout EXPERIMENTAL
		Switched to branch 'EXPERIMENTAL'
		XGavalda:Agar xgavalda$ git branch
		* EXPERIMENTAL
		  master

###Com borrar una branca.

```git branch -D <branca>```

##Fusionar Branques

Primer moures a la branca que vol rebra la fusio.

```git checkout master```

I amb el comandament...

```git merge <branca a amb sorvi>```

**Un exemple:**

	git checkout master
	git branch
	git merge test


**Tipus de fusio:**

1.	**Fast-Forward** (Simple i automaticament)
2. **Manual Merge** (Tens que intervidre per ajustar la fusio)


#GITHUB

Servidor Public amb opticions de privat

##GIT Clone (Clonar un projecta al ordinador)

```git clone *.git``` 

Fitxer de github.

##Crear un NOU REPOSITORI (web) i conectar-ho

```git remote add origin https://github.com/Xgavalda/Game-Agar-Nodejs-.git``` 

##Verificar conexiones

```git remote -v```

	XGavalda:Agar xgavalda$ git remote -v
	origin	https://github.com/Xgavalda/Game-Agar-Nodejs-.git (fetch)
	origin	https://github.com/Xgavalda/Game-Agar-Nodejs-.git (push)
	
##Desconecta GITHUB

```git remote remove origin```

##Pujar a GITHUB

```git push origin master```


```git push origin (branca)```

**Error** *Tens que anar...*

```git pull origin master```

**Força** *un pugada al Servidor GITHUB* per exemple per canviar el nom del commit (ja que no tenim cap fitxer canviar)

```git push origin master -f```

*Aixo s'ha deu que vaig crear el READ.ME desde la pagina web i m'ha donava comflicta*

#ISSUES (Que es fa falta, temps per completar-ho, etiquetes)

##Issues

Crear una FEINA a fer...

##Milestone

Crear una FEINA amb un **TEMPS** determinat.

##Labels


Etiquetas per solucionar problemes:
	
	1.	bug
	2.	duplicate
	3.	help
	4.	question


#Tags (etiquetas als commits)

1. Tags missatge
2. Tags lleugers


Per exemple serveis els tags per indicar VERSIONS.

	[commit 1][commit 2][commit 3][commit 4] ....
	
	[  T A G S     V e r s i o 1 ][ TAGS Version 2...

##Tags missatge

```git tag -a v1.0 -m "missatge"```

## Tags a una commit en concret

```git tag -a v1.0 -m "missatge" (MD5 del commit)```

##Tags lleugers

```git tab v1.0(versio)```

##Upload Tags a GITHUB

```git push origin v1.0(versio)```

**Tips**

Pujar **tots** el tags de cop.

```git push origin --tags```

#Grups (REPOSITORIS Grups de treballs socis)

Creacio d'una GRUP de treball per crear i crea usuaris.

Usuaris i privilegis.

Despres es pot transferir un REPOSITORI al GRUP DE TREBALL per que treballin tots amb ell.

##Baixar canvis del servidor (Branca oculta "SERVIDOR-TEMPORAL")

```git fetch origin```

##Merge de (Branca oculta -> Original "TEMPORAL->ORIGINAL")

```git merge origin/master```


##Conflicte s'ha esta treballan tots dos.

	1. Original [MASTER]
	2. User1 [Baixa de MASTER]
	3. User2 [Baixa de MASTER]
	4. User1 [Puja un modificacio]
	5. User2 [Vol pujar una modificacio] pero no pot.
	6. Perque GIT detecta que el servidor te canvis i User2 No esta actulitzat.			
			XGavalda:Agar xgavalda$ git push origin master
			To https://github.com/Xgavalda/Agar.git
			 ! [rejected]        master -> master (fetch first)
			error: failed to push some refs to 'https://github.com/Xgavalda/Agar.git'
			hint: Updates were rejected because the remote contains work that you do
			hint: not have locally. This is usually caused by another repository pushing
			hint: to the same ref. You may want to first integrate the remote changes
			hint: (e.g., 'git pull ...') before pushing again.
			hint: See the 'Note about fast-forwards' in 'git push --help' for details.

	7. Toca baixa els canvis [Servidor User1] a la BRANCA TEMPORAL
		
			git fetch origin
			
	8. Toca fusionar els canvis [TEMPORAL User1 / ORIGINAL User2] 
			git merge origin/master
	9. Obrir els fitxer que tenen problema, els marca com...
			<<<<<HEAD
				<h2 id="bienvenida">CodigoFacilito</h2>
			=========
				<h2 id="bienvenida">Bienvenidos Todos<h2>
			>>>>> origin/master
	10. S'ha de solucionar el problema i pujar-ho al servidor.
	11. S'ha de fer lo tradicional
	12. [USER2 despres de solucionar el problema puja tot al servidor]
	13. git add -A
	14. git commit -m "S'arreglet el conflita del user1 amb user2"
	15. git push origin master
	16. [USER1 s'ha de baixa tot un altre vegada per tindreu tot correcta]
	17. git fech origin [Baixa la branca TEMPORAL]
	18. git merge origin/master [Si te algun canvi torna a fer un MERGE]

#Repositos de 3ers (Que vols contribuir solament...)

Fork (una copia del ORIGINAL clone pero en GITHUB)

Amb un FORK tens una altre branca.

	[ORIGIN/MASTER] "La meva branca temporal"
		git fetch upstream (normalment)
	[UPSTREAM/MASTER] "Per actualitzar REPO del FORK per exemple JQUERY"
		git fetch origin
	[ORIGIN] "La fusio del les dos branques"
		git merge origin/master

##Conflicte que detecta una PERSONA que no te permisos dins del repo.

	1. Original [MASTER]
	2. User1 [Baixa de MASTER]
	3. User1 [Puja un modificacio] "com normalment"
	4. S'ha d'anar a la pagina web GITHUB i anar FORK i apreta <NEW PULL REQUEST>
	5. Documentar el NEW PULL REQUEST.

#Github Pages

##Github User

Creacio *d'una pagina per USUARI* s'ha de fer amb aquest ordre.

1.	[usuario].github.io
2. git clone
3. sincronitzar
4. [URL]

##Projecto -> pagina WEB [gh-pages] branca


Creacio *d'una pagina per un projecta* s'ha de fer amb aquest ordre.

1. [usuario].github.io
2. git clone
3. **git branch gh-pages** 
4. sincronitzar
5. [URL]/projecta


#Github Desployment

##SSH
### Generar Clau SSH
Per generar la clau ssh en MAC es molt facil

**ssh-keygen**

	[Pregunta on la vols guardar] Per defecta [home]/.ssh (Molt bona opcio ;-) )
	
	[Pregunta frase de seguritat] 
	
	[Torna a preguntar frase de seguritat]
	
	Mostrar el fitxers ocults.
	
	ls -rf
	
	cd .ssh
	
	id_rsa		 [privada]
	id_rsa.pub [public]
	
	WebServices USER
	
	SSH-KEYS 
	
	Dones d'alta la SSH a la pagina web 
	
	Nom "MAC"
	Descripcio (pegas el contigunat amb ssh....)


## Desploymet [github->Servidor]

Servidor per fer desploymet desde github.

	1.	[DigitalOcean](www.digitalocean.com)
	2. Heroku
	3. Amazon Web Services
	4. Webfaction
	5. [Bitnami](https://bitnami.com/)
	6. [Rackspace] (https://www.rackspace.com/es)

Els passos a seguir:

	1. Actualitzar GITHUB.
	2. Pagina DigitaOcean
	3. Configuracio clau publicar s'ha pugar al servidor DigitalOcean.
	4. conexio ssh
	5. [CONEXIO DESDE EL SERVIDOR]
	6. Instalar el paquet de GIT ubuntu per exemple <apt-get install git>
	7. ssh-keygen
	8. s'ha de copia el keygen del servidor a la pagina GITHUB. (s'ha de tindre les dos (pc)+(servidor))
	9. "ssh root@[dominio]" si no tens domini "ssh root@ip"
	10. Confirmar que vols fer servir la clau SSH. I et conectes.
	11. git pull origin Develop  (fetch + merge) "Develop branca de produccio"


#Git hooks (scripts githubs)

Scripts de accions per github.

Accions que tens:

	Name								Description
	*								Any time any event is triggered (Wildcard Event).
	commit_comment					Any time a Commit is commented on.
	create							Any time a Branch or Tag is created.
	delete							Any time a Branch or Tag is deleted.
	deployment						Any time a Repository has a new deployment created from the API.
	deployment_status				Any time a deployment for a Repository has a status update from the API.
	fork							Any time a Repository is forked.
	gollum							Any time a Wiki page is updated.
	issue_comment					Any time an Issue or Pull Request is commented on.
	issues							Any time an Issue is assigned, unassigned, labeled, unlabeled, opened, closed, or reopened.
	member							Any time a User is added as a collaborator to a non-Organization Repository.
	membership						Any time a User is added or removed from a team. Organization hooks only.
	page_build						Any time a Pages site is built or results in a failed build.
	public							Any time a Repository changes from private to public.
	pull_request_review_comment		Any time a comment is created on a portion of the unified diff of a pull request (the Files Changed tab).
	pull_request					Any time a Pull Request is assigned, unassigned, labeled, unlabeled, opened, closed, reopened, or synchronized (updated due to a new push in the branch that the pull request is tracking).
	push							Any Git push to a Repository, including editing tags or branches. Commits via API actions that update references are also counted. This is the default event.
	repository						Any time a Repository is created. Organization hooks only.
	release							Any time a Release is published in a Repository.
	status							Any time a Repository has a status update from the API
	team_add						Any time a team is added or modified on a Repository.
	watch							Any time a User stars a Repository.

## Per crear hooks (scripts github)

Les accions que crearem aquestes lineas:

	1.	git commit -m "Missatge" (entra amb accio el HOOK)
	2. HOOK -> git push ...
	3. HOOK -> s'ha conecta amb el servidor
	4. HOOK -> executa el deployment.sh
	5. HOOK -> s'ha posicionat amb la carpeta
	6. HOOK -> git pull ...

cd .git

cd .hooks

touch post-commit

nano post-commit


	#!/bin/sh
	git push origin Develop
	ssh root@[ip] 'bash -s' < deployment.sh

chmod +x post-commit

amb la **AREL** del projecta.

nano **deployment.sh**

	#!/bin/sh
	cd ../var/www/content/
	git pull origin Develop
	sudo services apache restart


------

**REFERENCIES**

[1][Codigo Facilito](http://codigofacilito.com)

